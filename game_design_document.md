# 游戏设计文档 (GDD) - Deep Evolution (暂定名)

| 项目 | 内容 |
| --- | --- |
| **版本** | 0.1 (MVP 验证原型) |
| **类型** | Top-Down Action Roguelite / Survival |
| **核心机制** | 物理模拟 + 模块化生物进化 |
| **引擎** | Unity (3D URP) |
| **平台** | PC (键鼠) |

---

## 1. 游戏概述 (Game Overview)

### 1.1 核心概念 (High Concept)

**《Spore》的生物编辑自由度 + 《Hades》的快节奏战斗。**
玩家控制一个原始的海底生物核心，在危险的深海竞技场中收集“生物质”。通过实时变异，将收集到的 DNA 转化为具体的身体器官（如蟹钳、触手、硬壳），从而在“高机动猎手”与“固定炮台珊瑚”等截然不同的生存形态间切换。

### 1.2 核心体验支柱 (Core Pillars)

1. **物理驱动的深海机动：** 模拟液体的阻力与惯性，移动具有“漂移感”，拒绝生硬的启停。
2. **所见即所得的进化：** 每一个属性的改变都必须体现在外观和物理碰撞模型的变化上（长出钳子 = 攻击范围变长）。
3. **极致的物理反馈：** 强调“肉体撕裂（顿帧）”与“甲壳弹刀（后坐力）”的差异化手感。

---

## 2. 操控与摄像机 (Controls & Camera)

### 2.1 视角设置

*   **投影模式：** Orthographic (正交投影)，创造 2.5D 的扁平化视觉风格。
*   **角度：** 3D Top-Down (垂直俯视 或 60度俯视)。
*   **行为：** 摄像机平滑跟随玩家 (Damping)，始终保持玩家在屏幕相对中心。

### 2.2 输入映射 (Twin-Stick Logic)

采用双摇杆射击逻辑的键鼠变体：

| 动作 | 输入按键 | 逻辑描述 |
| --- | --- | --- |
| **移动** | **W / A / S / D** | 施加物理力 (AddForce)。包含惯性滑行，松手后不会立即停止。 |
| **瞄准/转向** | **鼠标光标** | 角色模型始终旋转朝向鼠标指针所在的的世界坐标。 |
| **主攻击** | **鼠标左键** | 激活当前挂载在 `Front` 插槽的器官（如咬合、刺击）。 |
| **特殊技能** | **鼠标右键** | 激活 `Back` 或 `Tail` 插槽的功能（如喷气冲刺、硬化防御）。 |
| **互动** | **接近自动** | 靠近掉落物（生物质/DNA）自动磁力吸附。 |

---

## 3. 核心系统 (Core Systems)

### 3.1 模块化插槽系统 (The Socket System)

玩家角色由 `Core_Body` (核心球体) 和挂载在插槽上的 `Parts` (器官预制体) 组成。

*   **插槽定义 (Socket List):**
    *   `Socket_Front_L` (左攻)
    *   `Socket_Front_R` (右攻)
    *   `Socket_Back` (背部/防御)
    *   `Socket_Tail` (机动)

*   **进化逻辑:** 收集满资源 -> 游戏暂停 -> 弹出三选一 UI -> 玩家选择 -> **销毁旧 Prefab，在对应插槽实例化新 Prefab**。

### 3.2 两种核心 Build 原型 (MVP 验证目标)

为了验证系统的自由度，MVP 必须包含以下两套极端的 DNA 组合：

#### A. 猎手形态 (The Hunter)

*   **定位:** 高机动、高爆发、脆皮。
*   **核心组件:** `螳螂刀` (长攻击距离)、`流线型鳍` (极大减少水的阻力 Drag)。
*   **物理手感:** 移动极其灵敏，依靠惯性进行“Hit & Run”。

#### B. 珊瑚形态 (The Bunker)

*   **定位:** 极低机动、反伤坦克、区域控制。
*   **核心组件:** `重型钙化壳` (极大增加质量 Mass 和阻力 Drag)、`剧毒海葵` (被动光环)。
*   **物理手感:** 几乎无法被 WASD 推动（类似固着在海底），靠碰撞体弹开撞上来的敌人。

---

## 4. 战斗反馈设计 (Combat Feel)

### 4.1 攻击肉体 (The "Crunch")

当玩家攻击软体敌人时：

*   **Hit Stop (顿帧):** 攻击命中瞬间，`Time.timeScale` 设为 0，持续 0.05~0.1秒。
*   **Squash (形变):** 敌人沿攻击方向瞬间被压扁，然后弹回。
*   **VFX:** 生成背向喷射的液体粒子。

### 4.2 攻击硬壳 (The "Bounce")

当玩家攻击硬质敌人或被格挡时：

*   **Recoil (后坐力):** 玩家刚体收到反向的 `Impulse` 力，被弹开。
*   **Screen Shake (震动):** 短促、高频的摄像机位移震动。
*   **SFX:** 音高 (Pitch) 随机化的清脆撞击声。

---

## 5. MVP 资产需求 (Asset List)

**注意：** MVP 阶段不注重美术，重点在于形状的可识别性。

### 5.1 模型 (Primitives 即可)

*   **玩家核心:** 一个简单的球体 (Sphere)。
*   **器官 - 钳子:** 红色长方体 (Cube)。
*   **器官 - 尖刺:** 灰色圆锥体 (Cone)。
*   **器官 - 推进器:** 蓝色圆柱体 (Cylinder)。
*   **敌人 - 游荡者:** 红色小球体，带有一个眼睛贴图指示方向。

### 5.2 脚本 (Scripts)

1.  `PlayerController.cs`: 处理 WASD 施加力、鼠标朝向。
2.  `SocketManager.cs`: 管理插槽数组，处理 Prefab 的生成与销毁。
3.  `EnemyAI.cs`: 简单的“朝向玩家移动”逻辑。
4.  `GameFeelManager.cs`: 单例模式，处理顿帧和震动。
5.  `Projectile/Hitbox.cs`: 处理 `OnCollisionEnter` 伤害判定。

---

## 6. 技术规格 (Technical Specs)

*   **物理设置:**
    *   使用 Unity `Rigidbody`。
    *   Constraints: 勾选 **Freeze Position Y** (锁定高度), **Freeze Rotation X, Z** (防止翻滚)。
    *   Drag (阻力): 基础值设为 1-2，模拟水下环境；“猎手”形态降低 Drag，“珊瑚”形态增加 Drag。

*   **碰撞层 (Layers):**
    *   `Player`
    *   `Enemy`
    *   `PlayerAttack` (钳子的碰撞盒)
    *   `EnemyAttack` (敌人的身体)

---

## 7. 核心玩法深度设计 (Core Gameplay Deep Dive)

### 7.1. 形态定义与物理差异设计

基于文档中的物理驱动 和输入映射，我们需要在 PlayerController 中为这两种形态编写不同的力学逻辑。

#### A. 双侧对称：猎手/游鱼 (Bilateral Build)

> “速度就是生命，由于身体呈流线型，只能向前冲刺。”

**物理逻辑 (Anisotropic Physics):**

- **前向 (W):** 获得 120% 推力。
- **侧向 (A/D):** 仅获得 60% 推力（体现转向惯性）。
- **后退 (S):** 仅获得 30% 推力（倒车困难）。
- **转向:** 鼠标瞄准时，身体旋转速度 (Angular Drag) 较低，会有明显的“甩尾”感。

**优势:** 极高的追击能力和逃跑速度；正面爆发力强。
**劣势:** 转向半径大，一旦错过目标需要绕大圈调头；后背完全暴露。

#### B. 辐射对称：水母/海星 (Radial Build)

> “全向感知，没有死角，像飞碟一样在海底悬浮。”

**物理逻辑 (Isotropic Physics):**

- **全向 (W/A/S/D):** 所有方向获得均等的 80% 推力。
- **转向:** 角色模型本身不需要旋转（或者缓慢旋转），鼠标仅控制“武器发射方向”或“炮塔旋转”。
- **阻力 (Drag):** 设置较高的阻力，松开按键后能较快停下，实现精准走位。

**优势:** 极其灵活的微操（Micro-spacing），可以一边后退一边满额输出（Kiting），没有背面弱点。
**劣势:** 缺乏爆发性速度，无法通过冲刺摆脱高速敌人的纠缠。

### 7.2. 演化机制：如何“自然而然”地形成？

不要让玩家在 UI 上选择“我要玩双侧对称”，而是通过器官插槽 (Socket System) 的物理特性来引导。

我们引入一个概念：**推力矢量 (Thrust Vectoring)**。

#### 机制：器官决定运动模式

在游戏初期，给予玩家两种截然不同的“移动类器官”选择：

- **强力尾鳍 (Tail Fin) -> 导向双侧对称**
    - **挂载点:** 只能安装在 `Socket_Tail`。
    - **属性:** 提供巨大的 Forward Force。
    - **副作用:** 安装后，脚本强制锁定 PlayerController 为“各向异性”模式（即前方快、侧方慢）。
    - **引导:** 玩家为了追求速度安装尾鳍，自然就变成了“车”的操控手感，必须像鱼一样游动。

- **侧向喷口 (Side Jet) / 纤毛 (Cilia) -> 导向辐射对称**
    - **挂载点:** 安装在 `Socket_Front_L` 和 `Socket_Front_R`（或者新增侧面插槽）。
    - **属性:** 提供全向推力，增加旋转阻力（由喷口维持平衡）。
    - **引导:** 玩家为了追求灵活躲避安装侧向喷口，发现由于缺乏尾部主推力，身体自然变成了适合平移的“飞碟”。

#### 演化路线图 (Evolution Tree)

| 阶段 | 玩家行为 | 结果形态 | 获得的 Passives (被动) |
| --- | --- | --- | --- |
| 初始 | 只有核心球体 | 原始形态 (移动慢，全向相同) | 无 |
| 第一次进化 | 选择 [尾鳍] | 双侧对称 (T1) | 解锁“冲刺伤害加成” (利用速度撞击) |
| 第一次进化 | 选择 [多向喷口] | 辐射对称 (T1) | 解锁“全方位视野” (暴击率不随距离衰减) |
| 深度进化 | 继续强化尾部/头部 | 深海猎手 (极致速度) | 正面护甲增加，背部受伤加倍 |
| 深度进化 | 在四周挂载更多武器 | 浮游堡垒 (极致控制) | 自身旋转速度降低，但攻击范围扩大 |

### 7.3. 平衡性矩阵 (Balancing Matrix)

为了保证 PvP 或 PvE 的公平性，我们需要利用“攻击窗口”和“机动性”进行互补：

| 属性 | 双侧对称 (Bilateral) | 辐射对称 (Radial) | 平衡设计意图 |
| --- | --- | --- | --- |
| 最大速度 | ★★★★★ | ★★★☆☆ | 猎手必须能追上猎物，但容易失控撞墙。 |
| 加速度/启停 | ★★☆☆☆ | ★★★★★ | 辐射形态可以在弹幕中精细穿梭。 |
| 攻击角度 | 窄 (前方 90°) | 宽 (360° 或 自动索敌) | 猎手必须“车头对敌”才能输出；辐射形态可以“放风筝”。 |
| 防御弱点 | 致命的背部 (Backstab) | 受击面积大 (Hitbox大) | 猎手怕被绕后；辐射形态怕被包围/弹幕覆盖。 |
| 主要输出手段 | 动能撞击 / 刺击 | 散射 / 毒雾 / 激光 | 猎手利用 AddForce 的惯性造成物理伤害；辐射形态利用频率。 |
